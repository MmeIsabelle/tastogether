<div class="head-banner d-flex justify-content-between">
  <div class="head-title">
    <h1><%= @dashboard.user.username %></h1>
  </div>
  <div>
    <% if @dashboard.user.photo.attached? %>
      <%= cl_image_tag @dashboard.user.photo.key, :transformation=>[ {:width=>150, :height=>150, :gravity=>"face",
      :crop=>"thumb"}], class: "avatar dropdown-toggle" , id: "navbarDropdown" , data: { toggle: 'dropdown' }%>
    <% elsif @dashboard.user.avatar?%>
      <%= image_tag @dashboard.user.avatar, class: "avatar dropdown-toggle" , id: "navbarDropdown" , data: {
      toggle: 'dropdown' }%>
    <% else %>
      <%= image_tag 'https://res.cloudinary.com/dd3n6uf2t/image/upload/w_1000,c_fill,ar_1:1,g_auto,r_max,b_rgb:262c35/v1630205006/silhouette_od01kv.jpg', class: "avatar dropdown-toggle" , id: "navbarDropdown" , data: { toggle: 'dropdown' }%>
    <% end %>
    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
    <%= link_to "Logout" , destroy_user_session_path , method: :delete, class: "dropdown-item" %>
    </div>
  </div>
</div>
<div class="container">
  <div class="attending-pending my-4">
    <div>
      <h2>Pending tastings</h2>
      <div class="dashboard-cards ">
        <% @dashboard.pending_participations.each do |participation| %>
          <div class="dashboard-card">
            <% if participation.tasting.photo.attached? %>
              <%= cl_image_tag participation.tasting.photo.key%>
            <% else %>
              <%= image_tag participation.tasting.image%>
            <% end %>
            <h3><%= link_to participation.tasting.title, tasting_path(participation.tasting) %></h3>
            <p><%= participation.tasting.date.to_time.strftime('%B %e at %l:%M %p') %></p>
          </div>
        <% end %>
      <div>
    </div>
  </div>
  <div class="attending-upcoming my-4">
    <div>
      <h2>Upcoming tastings</h2>
      <div class="dashboard-cards">
        <% @dashboard.upcoming_tastings.each do |participation| %>
          <div class="dashboard-card">
            <% if participation.tasting.photo.attached? %>
              <%= cl_image_tag participation.tasting.photo.key%>
            <% else %>
              <%= image_tag participation.tasting.image%>
            <% end %>
            <h3><%= link_to participation.tasting.title, tasting_path(participation.tasting) %></h3>
            <p><%= participation.tasting.start_at.to_time.strftime('%B %e at %l:%M %p') %></p>
          </div>
        <% end %>
      </div>
    </div>
  </div>
  <div class="hosting my-4">
    <h2>Hostings</h2>
    <div class="dashboard-cards">
      <% @dashboard.hostings.each do |tasting| %>
        <div class="dashboard-card">
          <% if tasting.photo.attached? %>
            <%= cl_image_tag tasting.photo.key%>
          <% else %>
            <%= image_tag tasting.image%>
          <% end %>
          <h3><%= link_to tasting.title, tasting_path(tasting) %></h3>
          <p><%= tasting.start_at.to_time.strftime('%B %e at %l:%M %p') %></p>
          <div><%= tasting.participations.pending.size %></div>
        </div>
      <% end %>
    </div>
  </div>
  <div class="past my-4">
    <h2>Past tastings</h2>
    <div class="dashboard-cards">
      <% @dashboard.finished_tastings.each do |participation| %>
        <div class="dashboard-card">
          <% if participation.tasting.photo.attached? %>
            <%= cl_image_tag participation.tasting.photo.key%>
          <% else %>
            <%= image_tag participation.tasting.image%>
          <% end %>
          <h3><%= link_to participation.tasting.title, tasting_path(participation.tasting) %></h3>
          <p><%= participation.tasting.start_at.to_time.strftime('%B %e at %l:%M %p') %></p>
        </div>
      <% end %>
    </div>
  </div>
</div>
